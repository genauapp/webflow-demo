<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>GenauApp - German Learning Platform</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    
    <!-- Stripe Integration -->
    <meta name="stripe-key" content="pk_test_51xxxxxxxxx...">
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- Existing CSS -->
    <link href="css/globals.css" rel="stylesheet" type="text/css" />
    
    <style>
        /* Payment Modal Styles */
        #payment-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }
        
        .payment-modal-content {
            background: white;
            border-radius: 8px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .payment-message {
            padding: 12px;
            border-radius: 4px;
            margin: 16px 0;
        }
        
        .payment-message-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }
        
        .payment-message-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }
        
        #stripe-card-element {
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            margin: 16px 0;
        }
        
        .upgrade-banner {
            background: #3b82f6;
            color: white;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
            text-align: center;
        }
        
        .einburgerungstest-price {
            font-weight: bold;
            color: #3b82f6;
        }
    </style>
</head>

<body>
    <!-- Main Content -->
    <div class="container main-content">
        <h1>GenauApp - Einbürgerungstest</h1>
        
        <!-- Einbürgerungstest Content -->
        <div id="learn-question-container">
            <!-- Learn Tab Content -->
            <div id="learn-tab">
                <p>Learn tab content will be here...</p>
            </div>
            
            <!-- Test Tab -->
            <div id="test-tab" style="cursor: pointer; padding: 20px; background: #f3f4f6; border-radius: 8px; margin: 20px 0;">
                <h3>Start Einbürgerungstest</h3>
                <p>Click here to begin your citizenship test preparation</p>
            </div>
        </div>
        
        <!-- Skeleton Loading -->
        <div id="skeleton-container" style="display: none;">
            <p>Loading...</p>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="payment-modal">
        <div class="payment-modal-content">
            <!-- Modal Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h2>Upgrade to Premium</h2>
                <button id="payment-modal-close" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
            </div>
            
            <!-- Product Information -->
            <div style="text-align: center; margin-bottom: 32px;">
                <h3 id="product-name">Einbürgerungstest</h3>
                <div style="font-size: 24px; font-weight: bold; color: #3b82f6;">
                    <span id="product-price">€29.99</span>
                </div>
                <p style="color: #6b7280; margin-top: 8px;">Get unlimited access to all Einbürgerungstest questions and features</p>
            </div>
            
            <!-- Loading State -->
            <div id="payment-loading" style="display: none; text-align: center; padding: 40px;">
                <p>Loading payment form...</p>
            </div>
            
            <!-- Payment Form -->
            <form id="payment-form" style="display: none;">
                <!-- Currency Selector -->
                <div style="margin-bottom: 20px;">
                    <label for="currency-selector" style="display: block; margin-bottom: 8px; font-weight: 500;">Currency:</label>
                    <select id="currency-selector" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 4px;">
                        <option value="EUR">€ Euro</option>
                        <option value="USD">$ US Dollar</option>
                        <option value="TRY">₺ Turkish Lira</option>
                    </select>
                </div>
                
                <!-- Cardholder Name -->
                <div style="margin-bottom: 20px;">
                    <label for="cardholder-name" style="display: block; margin-bottom: 8px; font-weight: 500;">Cardholder Name:</label>
                    <input id="cardholder-name" type="text" placeholder="John Doe" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 4px;" required>
                </div>
                
                <!-- Billing Email -->
                <div style="margin-bottom: 20px;">
                    <label for="billing-email" style="display: block; margin-bottom: 8px; font-weight: 500;">Email Address:</label>
                    <input id="billing-email" type="email" placeholder="john@example.com" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 4px;" required>
                </div>
                
                <!-- Stripe Card Element -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500;">Card Information:</label>
                    <div id="stripe-card-element">
                        <!-- Stripe Elements will mount here -->
                    </div>
                    <div id="card-errors" style="color: #ef4444; margin-top: 8px; display: none;"></div>
                </div>
                
                <!-- Processing Text -->
                <div id="payment-processing-text" style="display: none; color: #3b82f6; text-align: center; margin: 16px 0;">
                    <p>Processing your payment securely with Stripe...</p>
                </div>
                
                <!-- Submit Button -->
                <button id="payment-submit" type="submit" style="width: 100%; padding: 16px; background: #3b82f6; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 500; cursor: pointer;">
                    Complete Purchase
                </button>
                
                <!-- Cancel Button -->
                <button id="payment-modal-cancel" type="button" style="width: 100%; padding: 12px; background: #f3f4f6; color: #374151; border: none; border-radius: 6px; font-size: 14px; margin-top: 12px; cursor: pointer;">
                    Cancel
                </button>
            </form>
            
            <!-- Success Message -->
            <div id="payment-success" class="payment-message payment-message-success" style="display: none;">
                Payment successful! You now have access to Einbürgerungstest.
            </div>
            
            <!-- Error Message -->
            <div id="payment-error" class="payment-message payment-message-error" style="display: none;">
                An error occurred during payment.
            </div>
            
            <!-- Already Paid Message -->
            <div id="already-paid-message" class="payment-message payment-message-success" style="display: none;">
                You already have access to Einbürgerungstest!
            </div>
        </div>
    </div>

    <!-- Authentication Modal (Existing) -->
    <div id="modal-signin-container" style="display: none;">
        <!-- Signin modal content would be here -->
        <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; display: flex; justify-content: center; align-items: center;">
            <div style="background: white; padding: 32px; border-radius: 8px; text-align: center;">
                <h3>Please Sign In</h3>
                <p>You need to sign in to access Einbürgerungstest</p>
                <button id="btn-modal-google-signin" style="padding: 12px 24px; background: #4285f4; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Sign in with Google
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/pages/einburgerungstest.js"></script>
</body>
</html>